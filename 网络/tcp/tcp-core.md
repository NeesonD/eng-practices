### Tcp 核心问题

![](pic/tcp-1.jpg)

**TCP 包头格式**

* 序号是为了解决**乱序问题**
* 确认序号是为了解决**不丢包**问题
* SYN 是发起一个连接，ACK 是回复，RST 是重新连接，FIN 是结束连接等。**维护连接**
* 窗口大小是为了**流量控制**

-----

**核心问题**

* 顺序问题 ，稳重不乱；
* 丢包问题，承诺靠谱；
* 连接维护，有始有终；
* 流量控制，把握分寸；
* 拥塞控制，知进知退

#### Tcp 握手和挥手

![](pic/tcp-syn.jpg)

* 为了保证可靠性，每一端都需要两次交互，所以应该是 4 次握手，但是服务端这边可以合并 ack + syn，所以是 3 次握手

![](pic/tcp-fin.jpg)

![](pic/tcp.jpg)